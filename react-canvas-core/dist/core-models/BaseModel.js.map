{"version":3,"file":"BaseModel.js","sourceRoot":"","sources":["../../src/core-models/BaseModel.ts"],"names":[],"mappings":"AAAA,OAAO,EACN,UAAU,EAMV,MAAM,cAAc,CAAC;AACtB,OAAO,EAAE,WAAW,EAAE,MAAM,gCAAgC,CAAC;AAoB7D,MAAM,OAAO,SAA2D,SAAQ,UAAa;IAG5F,YAAY,OAAqB;QAChC,KAAK,CAAC,OAAO,CAAC,CAAC;IAChB,CAAC;IAED,eAAe;QACd,OAAO,IAAI,CAAC;IACb,CAAC;IAED,oBAAoB;QACnB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;YAClB,OAAO,IAAI,CAAC;QACb,CAAC;QACD,IAAI,IAAI,CAAC,MAAM,YAAY,WAAW,EAAE,CAAC;YACxC,OAAO,IAAI,CAAC,MAAM,CAAC;QACpB,CAAC;aAAM,IAAI,IAAI,CAAC,MAAM,YAAY,SAAS,EAAE,CAAC;YAC7C,OAAO,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC;QAC3C,CAAC;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAED,SAAS;QACR,OAAO,IAAI,CAAC,MAAM,CAAC;IACpB,CAAC;IAED,SAAS,CAAC,MAAmB;QAC5B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACtB,CAAC;IAED,oBAAoB;QACnB,OAAO,CAAC,IAAI,CAAC,CAAC;IACf,CAAC;IAED,SAAS;QACR,uCACI,KAAK,CAAC,SAAS,EAAE,KACpB,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,EACvB,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ,EAC/B,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,IAC1B;IACH,CAAC;IAED,WAAW,CAAC,KAA6B;QACxC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QACzB,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC;QACxC,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC;IAC7C,CAAC;IAED,OAAO;QACN,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;IAC1B,CAAC;IAED,UAAU;QACT,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;IAC9B,CAAC;IAED,QAAQ;QACP,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;QAChC,IAAI,MAAM,EAAE,CAAC;YACZ,OAAO,IAAI,CAAC;QACb,CAAC;QAED,sCAAsC;QACtC,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YACjB,OAAO,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;QAC/B,CAAC;QACD,OAAO,KAAK,CAAC;IACd,CAAC;IAED,WAAW,CAAC,WAAoB,IAAI;QACnC,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,KAAK,QAAQ,EAAE,CAAC;YACxC,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAEjC,IAAI,CAAC,SAAS,CACb;gBACC,UAAU,EAAE,QAAQ;aACpB,EACD,kBAAkB,CAClB,CAAC;QACH,CAAC;IACF,CAAC;IAED,MAAM;QACL,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,eAAe,CAAC,CAAC;IACrC,CAAC;CACD","sourcesContent":["import {\r\n\tBaseEntity,\r\n\tBaseEntityEvent,\r\n\tBaseEntityGenerics,\r\n\tBaseEntityListener,\r\n\tBaseEntityOptions,\r\n\tDeserializeEvent\r\n} from './BaseEntity';\r\nimport { CanvasModel } from '../entities/canvas/CanvasModel';\r\n\r\nexport interface BaseModelListener extends BaseEntityListener {\r\n\tselectionChanged?(event: BaseEntityEvent<BaseModel> & { isSelected: boolean }): void;\r\n\r\n\tentityRemoved?(event: BaseEntityEvent<BaseModel>): void;\r\n}\r\n\r\nexport interface BaseModelOptions extends BaseEntityOptions {\r\n\ttype?: string;\r\n\tselected?: boolean;\r\n\textras?: any;\r\n}\r\n\r\nexport interface BaseModelGenerics extends BaseEntityGenerics {\r\n\tLISTENER: BaseModelListener;\r\n\tPARENT: BaseEntity;\r\n\tOPTIONS: BaseModelOptions;\r\n}\r\n\r\nexport class BaseModel<G extends BaseModelGenerics = BaseModelGenerics> extends BaseEntity<G> {\r\n\tprotected parent: G['PARENT'];\r\n\r\n\tconstructor(options: G['OPTIONS']) {\r\n\t\tsuper(options);\r\n\t}\r\n\r\n\tperformanceTune() {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetParentCanvasModel(): CanvasModel {\r\n\t\tif (!this.parent) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (this.parent instanceof CanvasModel) {\r\n\t\t\treturn this.parent;\r\n\t\t} else if (this.parent instanceof BaseModel) {\r\n\t\t\treturn this.parent.getParentCanvasModel();\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tgetParent(): G['PARENT'] {\r\n\t\treturn this.parent;\r\n\t}\r\n\r\n\tsetParent(parent: G['PARENT']) {\r\n\t\tthis.parent = parent;\r\n\t}\r\n\r\n\tgetSelectionEntities(): Array<BaseModel> {\r\n\t\treturn [this];\r\n\t}\r\n\r\n\tserialize() {\r\n\t\treturn {\r\n\t\t\t...super.serialize(),\r\n\t\t\ttype: this.options.type,\r\n\t\t\tselected: this.options.selected,\r\n\t\t\textras: this.options.extras\r\n\t\t};\r\n\t}\r\n\r\n\tdeserialize(event: DeserializeEvent<this>) {\r\n\t\tsuper.deserialize(event);\r\n\t\tthis.options.extras = event.data.extras;\r\n\t\tthis.options.selected = event.data.selected;\r\n\t}\r\n\r\n\tgetType(): string {\r\n\t\treturn this.options.type;\r\n\t}\r\n\r\n\tisSelected(): boolean {\r\n\t\treturn this.options.selected;\r\n\t}\r\n\r\n\tisLocked(): boolean {\r\n\t\tconst locked = super.isLocked();\r\n\t\tif (locked) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// delegate this call up to the parent\r\n\t\tif (this.parent) {\r\n\t\t\treturn this.parent.isLocked();\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tsetSelected(selected: boolean = true) {\r\n\t\tif (this.options.selected !== selected) {\r\n\t\t\tthis.options.selected = selected;\r\n\r\n\t\t\tthis.fireEvent(\r\n\t\t\t\t{\r\n\t\t\t\t\tisSelected: selected\r\n\t\t\t\t},\r\n\t\t\t\t'selectionChanged'\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tremove() {\r\n\t\tthis.fireEvent({}, 'entityRemoved');\r\n\t}\r\n}\r\n"]}