{"version":3,"file":"RightAngleLinkWidget.js","sourceRoot":"","sources":["../../src/link/RightAngleLinkWidget.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { DiagramEngine, LinkWidget, PointModel } from '@projectstorm/react-diagrams-core';\r\nimport { RightAngleLinkFactory } from './RightAngleLinkFactory';\r\nimport { DefaultLinkModel, DefaultLinkSegmentWidget } from '@projectstorm/react-diagrams-defaults';\r\nimport { Point } from '@projectstorm/geometry';\r\nimport { MouseEvent } from 'react';\r\nimport { RightAngleLinkModel } from './RightAngleLinkModel';\r\n\r\nexport interface RightAngleLinkProps {\r\n\tcolor?: string;\r\n\twidth?: number;\r\n\tsmooth?: boolean;\r\n\tlink: RightAngleLinkModel;\r\n\tdiagramEngine: DiagramEngine;\r\n\tfactory: RightAngleLinkFactory;\r\n}\r\n\r\nexport interface RightAngleLinkState {\r\n\tselected: boolean;\r\n\tcanDrag: boolean;\r\n}\r\n\r\nexport class RightAngleLinkWidget extends React.Component<RightAngleLinkProps, RightAngleLinkState> {\r\n\tpublic static defaultProps: RightAngleLinkProps = {\r\n\t\tcolor: 'red',\r\n\t\twidth: 3,\r\n\t\tlink: null,\r\n\t\tsmooth: false,\r\n\t\tdiagramEngine: null,\r\n\t\tfactory: null\r\n\t};\r\n\r\n\trefPaths: React.RefObject<SVGPathElement>[];\r\n\r\n\t// DOM references to the label and paths (if label is given), used to calculate dynamic positioning\r\n\trefLabels: { [id: string]: HTMLElement };\r\n\tdragging_index: number;\r\n\r\n\tconstructor(props: RightAngleLinkProps) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.refPaths = [];\r\n\t\tthis.state = {\r\n\t\t\tselected: false,\r\n\t\t\tcanDrag: false\r\n\t\t};\r\n\r\n\t\tthis.dragging_index = 0;\r\n\t}\r\n\r\n\tcomponentDidUpdate(): void {\r\n\t\tthis.props.link.setRenderedPaths(\r\n\t\t\tthis.refPaths.map((ref) => {\r\n\t\t\t\treturn ref.current;\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {\r\n\t\tthis.props.link.setRenderedPaths(\r\n\t\t\tthis.refPaths.map((ref) => {\r\n\t\t\t\treturn ref.current;\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentWillUnmount(): void {\r\n\t\tthis.props.link.setRenderedPaths([]);\r\n\t}\r\n\r\n\tgenerateLink(path: string, extraProps: any, id: string | number): JSX.Element {\r\n\t\tconst ref = React.createRef<SVGPathElement>();\r\n\t\tthis.refPaths.push(ref);\r\n\t\treturn (\r\n\t\t\t<DefaultLinkSegmentWidget\r\n\t\t\t\tkey={`link-${id}`}\r\n\t\t\t\tpath={path}\r\n\t\t\t\tselected={this.state.selected}\r\n\t\t\t\tdiagramEngine={this.props.diagramEngine}\r\n\t\t\t\tfactory={this.props.diagramEngine.getFactoryForLink(this.props.link)}\r\n\t\t\t\tlink={this.props.link}\r\n\t\t\t\tforwardRef={ref}\r\n\t\t\t\tonSelection={(selected) => {\r\n\t\t\t\t\tthis.setState({ selected: selected });\r\n\t\t\t\t}}\r\n\t\t\t\textras={extraProps}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\tcalculatePositions(points: PointModel[], event: MouseEvent, index: number, coordinate: string) {\r\n\t\t// If path is first or last add another point to keep node port on its position\r\n\t\tif (index === 0) {\r\n\t\t\tlet point = new PointModel({\r\n\t\t\t\tlink: this.props.link,\r\n\t\t\t\tposition: new Point(points[index].getX(), points[index].getY())\r\n\t\t\t});\r\n\t\t\tthis.props.link.addPoint(point, index);\r\n\t\t\tthis.dragging_index++;\r\n\t\t\treturn;\r\n\t\t} else if (index === points.length - 2) {\r\n\t\t\tlet point = new PointModel({\r\n\t\t\t\tlink: this.props.link,\r\n\t\t\t\tposition: new Point(points[index + 1].getX(), points[index + 1].getY())\r\n\t\t\t});\r\n\t\t\tthis.props.link.addPoint(point, index + 1);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Merge two points if it is not close to node port and close to each other\r\n\t\tif (index - 2 > 0) {\r\n\t\t\tlet _points = {\r\n\t\t\t\t[index - 2]: points[index - 2].getPosition(),\r\n\t\t\t\t[index + 1]: points[index + 1].getPosition(),\r\n\t\t\t\t[index - 1]: points[index - 1].getPosition()\r\n\t\t\t};\r\n\t\t\tif (Math.abs(_points[index - 1][coordinate] - _points[index + 1][coordinate]) < 5) {\r\n\t\t\t\t_points[index - 2][coordinate] = this.props.diagramEngine.getRelativeMousePoint(event)[coordinate];\r\n\t\t\t\t_points[index + 1][coordinate] = this.props.diagramEngine.getRelativeMousePoint(event)[coordinate];\r\n\t\t\t\tpoints[index - 2].setPosition(_points[index - 2]);\r\n\t\t\t\tpoints[index + 1].setPosition(_points[index + 1]);\r\n\t\t\t\tpoints[index - 1].remove();\r\n\t\t\t\tpoints[index - 1].remove();\r\n\t\t\t\tthis.dragging_index--;\r\n\t\t\t\tthis.dragging_index--;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Merge two points if it is not close to node port\r\n\t\tif (index + 2 < points.length - 2) {\r\n\t\t\tlet _points = {\r\n\t\t\t\t[index + 3]: points[index + 3].getPosition(),\r\n\t\t\t\t[index + 2]: points[index + 2].getPosition(),\r\n\t\t\t\t[index + 1]: points[index + 1].getPosition(),\r\n\t\t\t\t[index]: points[index].getPosition()\r\n\t\t\t};\r\n\t\t\tif (Math.abs(_points[index + 1][coordinate] - _points[index + 2][coordinate]) < 5) {\r\n\t\t\t\t_points[index][coordinate] = this.props.diagramEngine.getRelativeMousePoint(event)[coordinate];\r\n\t\t\t\t_points[index + 3][coordinate] = this.props.diagramEngine.getRelativeMousePoint(event)[coordinate];\r\n\t\t\t\tpoints[index].setPosition(_points[index]);\r\n\t\t\t\tpoints[index + 3].setPosition(_points[index + 3]);\r\n\t\t\t\tpoints[index + 1].remove();\r\n\t\t\t\tpoints[index + 1].remove();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// If no condition above handled then just update path points position\r\n\t\tlet _points = {\r\n\t\t\t[index]: points[index].getPosition(),\r\n\t\t\t[index + 1]: points[index + 1].getPosition()\r\n\t\t};\r\n\t\t_points[index][coordinate] = this.props.diagramEngine.getRelativeMousePoint(event)[coordinate];\r\n\t\t_points[index + 1][coordinate] = this.props.diagramEngine.getRelativeMousePoint(event)[coordinate];\r\n\t\tpoints[index].setPosition(_points[index]);\r\n\t\tpoints[index + 1].setPosition(_points[index + 1]);\r\n\t}\r\n\r\n\tdraggingEvent(event: MouseEvent, index: number) {\r\n\t\tlet points = this.props.link.getPoints();\r\n\t\t// get moving difference. Index + 1 will work because links indexes has\r\n\t\t// length = points.lenght - 1\r\n\t\tlet dx = Math.abs(points[index].getX() - points[index + 1].getX());\r\n\t\tlet dy = Math.abs(points[index].getY() - points[index + 1].getY());\r\n\r\n\t\t// moving with y direction\r\n\t\tif (dx === 0) {\r\n\t\t\tthis.calculatePositions(points, event, index, 'x');\r\n\t\t} else if (dy === 0) {\r\n\t\t\tthis.calculatePositions(points, event, index, 'y');\r\n\t\t}\r\n\t\tthis.props.link.setFirstAndLastPathsDirection();\r\n\t}\r\n\r\n\thandleMove = function (event: MouseEvent) {\r\n\t\tthis.draggingEvent(event, this.dragging_index);\r\n\t}.bind(this);\r\n\r\n\thandleUp = function (event: MouseEvent) {\r\n\t\t// Unregister handlers to avoid multiple event handlers for other links\r\n\t\tthis.setState({ canDrag: false, selected: false });\r\n\t\twindow.removeEventListener('mousemove', this.handleMove);\r\n\t\twindow.removeEventListener('mouseup', this.handleUp);\r\n\t}.bind(this);\r\n\r\n\trender() {\r\n\t\t//ensure id is present for all points on the path\r\n\t\tlet points = this.props.link.getPoints();\r\n\t\tlet paths = [];\r\n\r\n\t\t// Get points based on link orientation\r\n\t\tlet pointLeft = points[0];\r\n\t\tlet pointRight = points[points.length - 1];\r\n\t\tlet hadToSwitch = false;\r\n\t\tif (pointLeft.getX() > pointRight.getX()) {\r\n\t\t\tpointLeft = points[points.length - 1];\r\n\t\t\tpointRight = points[0];\r\n\t\t\thadToSwitch = true;\r\n\t\t}\r\n\t\tlet dy = Math.abs(points[0].getY() - points[points.length - 1].getY());\r\n\r\n\t\t// When new link add one middle point to get everywhere 90° angle\r\n\t\tif (this.props.link.getTargetPort() === null && points.length === 2) {\r\n\t\t\t[...Array(2)].forEach((item) => {\r\n\t\t\t\tthis.props.link.addPoint(\r\n\t\t\t\t\tnew PointModel({\r\n\t\t\t\t\t\tlink: this.props.link,\r\n\t\t\t\t\t\tposition: new Point(pointLeft.getX(), pointRight.getY())\r\n\t\t\t\t\t}),\r\n\t\t\t\t\t1\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t\tthis.props.link.setManuallyFirstAndLastPathsDirection(true, true);\r\n\t\t}\r\n\t\t// When new link is moving and not connected to target port move with middle point\r\n\t\t// TODO: @DanielLazarLDAPPS This will be better to update in DragNewLinkState\r\n\t\t//  in function fireMouseMoved to avoid calling this unexpectedly e.g. after Deserialize\r\n\t\telse if (this.props.link.getTargetPort() === null && this.props.link.getSourcePort() !== null) {\r\n\t\t\tpoints[1].setPosition(\r\n\t\t\t\tpointRight.getX() + (pointLeft.getX() - pointRight.getX()) / 2,\r\n\t\t\t\t!hadToSwitch ? pointLeft.getY() : pointRight.getY()\r\n\t\t\t);\r\n\t\t\tpoints[2].setPosition(\r\n\t\t\t\tpointRight.getX() + (pointLeft.getX() - pointRight.getX()) / 2,\r\n\t\t\t\t!hadToSwitch ? pointRight.getY() : pointLeft.getY()\r\n\t\t\t);\r\n\t\t}\r\n\t\t// Render was called but link is not moved but user.\r\n\t\t// Node is moved and in this case fix coordinates to get 90° angle.\r\n\t\t// For loop just for first and last path\r\n\t\telse if (!this.state.canDrag && points.length > 2) {\r\n\t\t\t// Those points and its position only will be moved\r\n\t\t\tfor (let i = 1; i < points.length; i += points.length - 2) {\r\n\t\t\t\tif (i - 1 === 0) {\r\n\t\t\t\t\tif (this.props.link.getFirstPathXdirection()) {\r\n\t\t\t\t\t\tpoints[i].setPosition(points[i].getX(), points[i - 1].getY());\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpoints[i].setPosition(points[i - 1].getX(), points[i].getY());\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.props.link.getLastPathXdirection()) {\r\n\t\t\t\t\t\tpoints[i - 1].setPosition(points[i - 1].getX(), points[i].getY());\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpoints[i - 1].setPosition(points[i].getX(), points[i - 1].getY());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// If there is existing link which has two points add one\r\n\t\t// NOTE: It doesn't matter if check is for dy or dx\r\n\t\tif (points.length === 2 && dy !== 0 && !this.state.canDrag) {\r\n\t\t\tthis.props.link.addPoint(\r\n\t\t\t\tnew PointModel({\r\n\t\t\t\t\tlink: this.props.link,\r\n\t\t\t\t\tposition: new Point(pointLeft.getX(), pointRight.getY())\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tfor (let j = 0; j < points.length - 1; j++) {\r\n\t\t\tpaths.push(\r\n\t\t\t\tthis.generateLink(\r\n\t\t\t\t\tLinkWidget.generateLinePath(points[j], points[j + 1]),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'data-linkid': this.props.link.getID(),\r\n\t\t\t\t\t\t'data-point': j,\r\n\t\t\t\t\t\tonMouseDown: (event: MouseEvent) => {\r\n\t\t\t\t\t\t\tif (event.button === 0) {\r\n\t\t\t\t\t\t\t\tthis.setState({ canDrag: true });\r\n\t\t\t\t\t\t\t\tthis.dragging_index = j;\r\n\t\t\t\t\t\t\t\t// Register mouse move event to track mouse position\r\n\t\t\t\t\t\t\t\t// On mouse up these events are unregistered check \"this.handleUp\"\r\n\t\t\t\t\t\t\t\twindow.addEventListener('mousemove', this.handleMove);\r\n\t\t\t\t\t\t\t\twindow.addEventListener('mouseup', this.handleUp);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonMouseEnter: (event: MouseEvent) => {\r\n\t\t\t\t\t\t\tthis.setState({ selected: true });\r\n\t\t\t\t\t\t\tthis.props.link.lastHoverIndexOfPath = j;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tj\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.refPaths = [];\r\n\t\treturn <g data-default-link-test={this.props.link.getOptions().testName}>{paths}</g>;\r\n\t}\r\n}\r\n"]}